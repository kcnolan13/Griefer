<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sprite401</spriteName>
  <solid>0</solid>
  <visible>0</visible>
  <depth>0</depth>
  <persistent>-1</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///init
stat_flag = FL_NORMAL
ts = NO_HANDLE

grav_name = "GoshDarnNoOne"
grav_ready = false

netvars = ds_map_create()

time_match_start = 0
time_match = 0
time_match_end = 0
time_match_total = 0

tabs[0] = "Competitive"
tabs[1] = "Bot Mode"
tabs[2] = "Leaderboards"

stat_tab = tabs[0]

wiped = false

//history chart
history_chart = NO_HANDLE
history_chart_width = 64*7
history_chart_height = 64*5

//working copy of YOUR stats to be displayed on the stats page
varWrite("ppl",-1)
varWrite("kdr",-1)
varWrite("wl",-1)
varWrite("kills",-1)
varWrite("deaths",-1)
varWrite("assists",-1)
varWrite("wins",-1)
varWrite("losses",-1)
varWrite("kill_streak",-1)
varWrite("win_streak",-1)
varWrite("global_rank",-1)
varWrite("rank",-1)
varWrite("xp",-1)
varWrite("time",-1)
varWrite("points",-1)
varWrite("true_skill",-1)

//arrays for YOUR personal stat labels
pstats[PSTAT_KILLS] = "kills"
pstats[PSTAT_DEATHS] = "deaths"
pstats[PSTAT_ASSISTS] = "assists"
pstats[PSTAT_WINS] = "wins"
pstats[PSTAT_LOSSES] = "losses"
pstats[PSTAT_KILL_STREAK] = "kill_streak"
pstats[PSTAT_WIN_STREAK] = "win_streak"
pstats[PSTAT_TIME] = "time"
pstats[PSTAT_TSKILL] = "true_skill"

len = getLength(pstats)

pstat_labels[len-1] = -5

for (var i=0; i&lt;len; i++)
{
    pstat_labels[i] = NO_HANDLE
}

pstat_vals[len-1] = -5
for (var i=0; i&lt;len; i++)
{
    pstat_vals[i] = NO_HANDLE
}

pstat_pname = NO_HANDLE
pstat_title = NO_HANDLE
leaderboards_title = NO_HANDLE

//used for kdr, wl, ppl computations
varWrite("kdr_history","")
varWrite("ppl_history","")
varWrite("win_history","")
varWrite("kills_valid",false)
varWrite("deaths_valid",false)
varWrite("assists_valid",false)
varWrite("wins_valid",false)
varWrite("losses_valid",false)
varWrite("points_valid",false)
update_kdr = true
update_wl = false
update_ppl = false

update_flag = FL_COMPETITIVE

ppl_max = POINTS_KILL*10

//meters
meters[METER_KDR] = NO_HANDLE
meters[METER_WL] = NO_HANDLE
meters[METER_PPL] = NO_HANDLE
meters[METER_RANK] = NO_HANDLE

meter_stats[METER_KDR] = "kdr"
meter_stats[METER_WL] = "wl"
meter_stats[METER_PPL] = "ppl"
meter_stats[METER_RANK] = "rank"

meter_col_outs[METER_KDR] = web_hsv(0,100,100)
meter_col_outs[METER_WL] = web_hsv(207,100,100)
meter_col_outs[METER_PPL] = web_hsv(149,100,100)
meter_col_outs[METER_RANK] = web_hsv(0,0,0)

meter_col_ins[METER_KDR] = web_hsv(0,100,100)
meter_col_ins[METER_WL] = web_hsv(207,100,100)
meter_col_ins[METER_PPL] = web_hsv(149,100,100)
meter_col_ins[METER_RANK] = web_hsv(0,0,0)

meter_descs[METER_KDR] = "KDR"
meter_descs[METER_WL] = "W/L"
meter_descs[METER_PPL] = "PPL"
meter_descs[METER_RANK] = global.tskill

meter_radius = 64*3.5
meter_swath = 135
meter_ang_i = 90+meter_swath/2
meter_ang_f = 90-meter_swath/2
meter_ang_dif = abs(meter_ang_i - meter_ang_f)
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///set stat flag

if in_match() and net_manager.bot_match
    stat_flag = FL_BOT
else
    stat_flag = FL_COMPETITIVE
    
if in_match()
{
    //make sure you're working with the right accolades/stats grid
    request_personal_stats(grav_name,stat_flag)
    request_accolades(grav_name,stat_flag)
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>manage stat page modals</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///manage stat modals + meters
if in_match() or room = rm_login exit

if net_manager.menu_mode = "stats"
{
    wiped = false
    switch (stat_tab)
    {
        //competitive
        case "Competitive":
            if grav_ready
            {
                fade_modal(modal_table)
                if instance_exists(leaderboards_title)
                {
                    fade_modal(leaderboards_title)
                    leaderboards_title = NO_HANDLE
                }
                manage_meters()
            }
            else
            {
                if instance_exists(pstat_title)
                {
                    printf("ERROR: pstat_title exists but grav not ready ... help...")
                }
            }
        break
        
        //bot mode
        case "Bot Mode":
            if grav_ready
            {
                fade_modal(modal_table)
                if instance_exists(leaderboards_title)
                {
                    fade_modal(leaderboards_title)
                    leaderboards_title = NO_HANDLE
                }
                manage_meters()
            }
        break
        
        //leaderboards
        case "Leaderboards":
            if not instance_exists(modal_table)
            {
                leaderboards = instance_create(room_width*1/2,room_height*1/2+54,modal_table)
                leaderboards.menu_mode = "stats"
                page_orderby = "stats"+".true_skill"
                page_flag = FL_FINDME
                scr_bn_page_leaderboards()
            }
            
            if not instance_exists(leaderboards_title)
            {
                //recreate title
                tit = instance_create(room_width/2,room_height*1/5-32-2000,bn_slabel)
                leaderboards_title = tit
                tit.text = "Worldwide   Competitive   Leaderboards"
                tit.width = 64*17
                tit.height = 64
                tit.font = fnt_leaderboards
                tit.birth_delay = 10
                tit.text_color = web_hsv(0,0,4)
                tit.alpha_max = 0
                tit.menu_mode = "stats"
            }
        break
    }
}
else if not wiped//not in stats mode
{
    wipe_stat_modals()
}

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///update kdr, wl, ppl sometimes

if update_kdr and varRead("kills_valid") and varRead("deaths_valid")
{
    if in_match() update_flag = stat_flag
    update_kdr = false
    var kdr = truncate(varRead("kills")/max(1,varRead("deaths")),2)
    stat_update_real("kdr",kdr,update_flag)
    varWrite("kdr",kdr)
}

if update_wl and varRead("wins_valid") and varRead("losses_valid")
{
    if in_match() update_flag = stat_flag
    update_wl = false
    var wl = truncate(varRead("wins")/max(1,varRead("losses")),2)
    stat_update_real("wl",wl,update_flag)
    varWrite("wl",wl)
}

if update_ppl and varRead("points_valid") and varRead("deaths_valid")
{
    if in_match() update_flag = stat_flag
    update_ppl = false
    var ppl = truncate(varRead("points")/max(1,varRead("deaths")),2)
    stat_update_real("ppl",ppl,update_flag)
    varWrite("ppl",ppl)
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///room start

//set stat_flag
stat_flag = FL_NORMAL
alarm[0] = 3

/* THIS IS DONE ON RECEIVED LOCK ARMORY NOW
if in_match()
{
    time_match_start = current_time
    if instance_exists(net_manager.stat_gravatar)
    {
        objVarWrite(net_manager.stat_gravatar,"pName",playerName(myAvatar()))
        grav_name = playerName(myAvatar())
        request_personal_stats(playerName(myAvatar()),stat_flag)
    } else printf("ERROR: stat_manager room start cannot find net_manager.stat_gravatar")
}
*?
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
